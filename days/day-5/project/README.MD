# The Verifier ğŸ‘¨â€ğŸ« / æ¤œè¨¼è€… ğŸ‘¨â€ğŸ«
## Introduction / ã¯ã˜ã‚ã«
Imagine that you are now an instructor at [Motoko School](https://twitter.com/MotokoSchool), where you are currently overseeing a cohort of more than 200 dedicated students!  ğŸ¤¯  
ã‚ãªãŸã¯ä»Šã€[Motoko School](https://twitter.com/MotokoSchool) ã®è¬›å¸«ã¨ã—ã¦ã€200äººã‚’è¶…ãˆã‚‹ç†±å¿ƒãªç”Ÿå¾’ã‚’æŒ‡å°ã—ã¦ã„ã‚‹ã¨æƒ³åƒã—ã¦ãã ã•ã„ï¼ ğŸ¤¯<br/>
As part of the program, you have assigned these ambitious learners to tackle 4 distinct projects, each designed to challenge their skills and knowledge. Upon completion, it falls on your shoulders to meticulously review and evaluate their work, ultimately determining whether they have met the criteria for [graduation](../../../README.MD#ğŸ“-graduation).  
ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä¸€ç’°ã¨ã—ã¦ã€ã‚ãªãŸã¯æ„æ¬²çš„ãªå­¦ç¿’è€…ã«4ã¤ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èª²ã—ã€ãã‚Œãã‚Œã®ã‚¹ã‚­ãƒ«ã¨çŸ¥è­˜ã«æŒ‘æˆ¦ã•ã›ã¾ã—ãŸã€‚ä¿®äº†å¾Œã¯ã€å½¼ã‚‰ã®ä½œå“ã‚’ä¸¹å¿µã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã€è©•ä¾¡ã—ã€æœ€çµ‚çš„ã« [å’æ¥­](../../../README.MD#ğŸ“-graduation) ã®åŸºæº–ã‚’æº€ãŸã—ãŸã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã®ãŒã‚ãªãŸã®å½¹ç›®ã§ã™ã€‚ <br/>
Fortunately, as an adept Motoko developer yourself, you possess the expertise and confidence to streamline this verification process by leveraging automation. This innovative approach will not only save you valuable time but also pave the way for the future of **Motoko Bootcamp**.  
å¹¸ã„ãªã“ã¨ã«ã€Motoko ã®é–‹ç™ºè€…ã§ã‚ã‚‹ã‚ãªãŸã«ã¯ã€è‡ªå‹•åŒ–ã‚’æ´»ç”¨ã—ã¦ã“ã®æ¤œè¨¼ãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆç†åŒ–ã™ã‚‹å°‚é–€çŸ¥è­˜ã¨è‡ªä¿¡ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®é©æ–°çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€ã‚ãªãŸã®è²´é‡ãªæ™‚é–“ã‚’ç¯€ç´„ã™ã‚‹ã ã‘ã§ãªãã€**Motoko Bootcamp** ã®æœªæ¥ã¸ã®é“ã‚’é–‹ãã“ã¨ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚
## ğŸ§‘â€ğŸ« Requirements / å‰ææ¡ä»¶
Your task is to create the code for an **instructor**, which is implemented as a canister. The idea is for the student to input his canister id and get automatically verified by the canister. If the canister id submitted fulfill the requirements then the students will automatically graduate; just imagine the HOURS of work you will save!  
ã‚ãªãŸã®ä»•äº‹ã¯ã€ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã¨ã—ã¦å®Ÿè£…ã•ã‚ŒãŸ **ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ¼** ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã™ã€‚ç”Ÿå¾’ãŒè‡ªåˆ†ã®ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ ID ã‚’å…¥åŠ›ã—ã€ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã«ã‚ˆã£ã¦è‡ªå‹•çš„ã«èªè¨¼ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã™ã€‚æå‡ºã•ã‚ŒãŸã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ ID ãŒè¦ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚Œã°ã€å­¦ç”Ÿã¯è‡ªå‹•çš„ã«å’æ¥­ã§ãã¾ã™ï¼<br/>

> For the purpose of this Bootcamp, we will not attempt to build a verifier that test all 4 previous projects. We will only attempts to verify a simple version of the calculator you've implemented during Day 1. The code for this simple calculator has already been implemented for you, and can be found [here](../project/calculator/calculator.mo).  

> ã“ã® Bootcamp ã§ã¯ã€éå»ã«å®Ÿæ–½ã—ãŸï¼”ã¤ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã™ã¹ã¦ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹æ¤œè¨¼æ©Ÿã‚’ä½œã‚ã†ã¨ã¯ã—ã¾ã›ã‚“ã€‚ï¼‘æ—¥ç›®ã«å®Ÿè£…ã—ãŸé›»å“ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æ¤œè¨¼ã®ã¿ã‚’è©¦ã¿ã¾ã™ã€‚ã“ã®ã‚·ãƒ³ãƒ—ãƒ«ãªé›»å“ã®ã‚³ãƒ¼ãƒ‰ã¯ã™ã§ã«å®Ÿè£…ã•ã‚Œã¦ãŠã‚Šã€[ã“ã“](../project/calculator/calculator.mo)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## Part 1: Storing the students information. / ç¬¬ï¼‘å›ï¼šå­¦ç”Ÿæƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ã€‚
The idea in this section is to build the code for storing informations about students.  
ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€å­¦ç”Ÿã«é–¢ã™ã‚‹æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ã§ã™ã€‚

### Step-by-step / ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—
A student profile is defined as follows:  
å­¦ç”Ÿãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™ï¼š
```motoko
public type StudentProfile = {
    name : Text;
    team : Text;
    graduate : Bool;
};
```
1. Define a variable named `studentProfileStore`, which is a `HashMap` for storing student profile. The keys in this map are of type `Principal` and represent the identity of students, while the values are of type `StudentProfile`.  
`studentProfileStore` ã¨ã„ã†åå‰ã®å¤‰æ•°ã‚’å®šç¾©ã—ãªã•ã„ã€‚ã“ã‚Œã¯å­¦ç”Ÿã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã® `HashMap` ã§ã™ã€‚ã“ã®ãƒãƒƒãƒ—ã®ã‚­ãƒ¼ã¯ `Principal` å‹ã§ã€å­¦ç”Ÿã®IDã‚’è¡¨ã—ã€å€¤ã¯ `StudentProfile` å‹ã§ã™ã€‚
2. Implement the `addMyProfile` function which accepts a `profile` of type `StudentProfile` and adds it into the `studentProfileStore`. This function assumes that the `caller` is the student corresponding to the profile.  
å‹ `StudentProfile` ã® `profile` ã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚’ `studentProfileStore` ã«è¿½åŠ ã™ã‚‹ `addMyProfile` é–¢æ•°ã‚’å®Ÿè£…ã—ãªã•ã„ã€‚ã“ã®é–¢æ•°ã¯ã€`caller` ãŒãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾å¿œã™ã‚‹å­¦ç”Ÿã§ã‚ã‚‹ã¨ä»®å®šã—ã¦ã„ã¾ã™ã€‚
```motoko
addMyProfile: shared (profile : StudentProfile) -> async Result.Result<(), Text>;
```
3. Implement the `seeAProfile` query function, which accepts a principal `p` of type `Principal` and returns the optional corresponding student profile.  
`seeAProfile` ã‚¯ã‚¨ãƒªãƒ¼é–¢æ•°ã‚’å®Ÿè£…ã—ãªã•ã„ã€‚ã“ã®é–¢æ•°ã¯ `Principal` å‹ã® principal `p` ã‚’å—ã‘å–ã‚Šã€principal ã«å¯¾å¿œã™ã‚‹ optional ãªå­¦ç”Ÿãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿”ã—ã¾ã™ã€‚
```motoko
seeAProfile : query (p : Principal) -> async Result.Result<StudentProfile, Text>;
```
4. Implement the `updateMyProfile` function which allows a student to perform a modification on its student profile. If everything works, and the profile is updated the function should return a simple unit value wrapped in an `Ok` result. If the `caller` doesn't have a student profile the function should return an error message wrapped in an `Err` result.  
å­¦ç”ŸãŒå­¦ç”Ÿãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã§ãã‚‹ `updateMyProfile` é–¢æ•°ã‚’å®Ÿè£…ã—ãªã•ã„ã€‚ã™ã¹ã¦ãŒã†ã¾ãã„ãã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãŒæ›´æ–°ã•ã‚ŒãŸå ´åˆã€é–¢æ•°ã¯ `Ok` result ã«ãƒ©ãƒƒãƒ—ã•ã‚ŒãŸå˜ç´”ãª unit å€¤ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚‚ã— `caller` ãŒå­¦ç”Ÿãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒã£ã¦ã„ãªã„å ´åˆã€ã“ã®é–¢æ•°ã¯ `Err` result ã«ãƒ©ãƒƒãƒ—ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```motoko
updateMyProfile : shared (profile : StudentProfile) -> async Result.Result<(), Text>;
```
5. Implement the `deleteMyProfile` function which allows a student to delete its student profile. If everything works, and the profile is deleted the function should return a simple unit value wrapped in an `Ok` result. If the `caller` doesn't have a student profile the function should return an error message wrapped in an `Err` result.  
å­¦ç”ŸãŒå­¦ç”Ÿãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã§ãã‚‹ `deleteMyProfile` é–¢æ•°ã‚’å®Ÿè£…ã—ãªã•ã„ã€‚ã™ã¹ã¦ãŒã†ã¾ãã„ãã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãŒå‰Šé™¤ã•ã‚ŒãŸå ´åˆã€é–¢æ•°ã¯ `Ok` çµæœã«ãƒ©ãƒƒãƒ—ã•ã‚ŒãŸå˜ç´”ãª unit å€¤ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚‚ã— `caller` ãŒå­¦ç”Ÿãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒã£ã¦ã„ãªã„å ´åˆã€ã“ã®é–¢æ•°ã¯ `Err` result ã«ãƒ©ãƒƒãƒ—ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```motoko
deleteMyProfile : shared () -> async Result.Result<(), Text>;
```
## Part 2: Testing of the simple calculator. / ç¬¬2éƒ¨ï¼šç°¡æ˜“é›»å“ã®ãƒ†ã‚¹ãƒˆã€‚
The goal of this section is to write the code for testing the functionality of the simple calculator (you don't need to write the code for this one! I've already done it). We will will test threee functions:  
ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®æ¨™ã¯ã€ã‚·ãƒ³ãƒ—ãƒ«ãªé›»å“ã®æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ã§ã™ï¼ˆã“ã®ã‚³ãƒ¼ãƒ‰ã¯æ›¸ãå¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ï¼ç§ã¯ã™ã§ã«ã‚„ã£ã¦ã„ã¾ã™ï¼‰ã€‚ç§ãŸã¡ã¯ã€ï¼“ã¤ã®é–¢æ•°ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ï¼š
- The `reset` function.
- The `add` function.
- The `sub` function.

If these three functions are correctly implemented, it indicates a successful test, validating the canister. During the calculator testing, we will perform inter-canister calls, considering three different scenarios:  
ã“ã‚Œã‚‰3ã¤ã®é–¢æ•°ãŒæ­£ã—ãå®Ÿè£…ã•ã‚Œã¦ã„ã‚Œã°ã€ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ãŸã“ã¨ã‚’ç¤ºã—ã€ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã‚’æ¤œè¨¼ã§ãã¾ã™ã€‚é›»å“ãƒ†ã‚¹ãƒˆã§ã¯ã€3ã¤ã®ã‚·ãƒŠãƒªã‚ªã‚’æƒ³å®šã—ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã‚³ãƒ¼ãƒ«ã‚’è¡Œã„ã¾ã™ï¼š

- Scenario 1: The calls to the calculator are executed correctly, but the returned results are not as expected. For example, if calling reset followed by add(1) returns 2 instead of the expected result.
- ã‚·ãƒŠãƒªã‚ª1ï¼šé›»å“ã®å‘¼ã³å‡ºã—ã¯æ­£ã—ãå®Ÿè¡Œã•ã‚Œã‚‹ãŒã€è¿”ã•ã‚Œã‚‹çµæœãŒæœŸå¾…é€šã‚Šã§ãªã„ã€‚ä¾‹ãˆã°ã€resetã®å¾Œã«add(1)ã‚’å‘¼ã³å‡ºã™ã¨ã€æœŸå¾…é€šã‚Šã®çµæœã§ã¯ãªãã€2ãŒè¿”ã•ã‚Œã‚‹å ´åˆã€‚
- Scenario 2: The calls to the calculator are executed correctly, and the returned results match our expectations.
- ã‚·ãƒŠãƒªã‚ª2ï¼šé›»å“ã®å‘¼ã³å‡ºã—ã¯æ­£ã—ãå®Ÿè¡Œã•ã‚Œã€è¿”ã•ã‚ŒãŸçµæœã¯æœŸå¾…ã«æ²¿ã†ã‚‚ã®ã§ã‚ã‚‹ã€‚
- Scenario 3: The calls to the calculator fail. This could be due to reasons such as the calculator not implementing the add function, not being deployed on the network, or running out of computation cycles.
- ã‚·ãƒŠãƒªã‚ª3ï¼šé›»å“ã®å‘¼ã³å‡ºã—ã«å¤±æ•—ã™ã‚‹ã€‚ã“ã‚Œã¯ã€é›»å“ãŒåŠ ç®—é–¢æ•°ã‚’å®Ÿè£…ã—ã¦ã„ãªã„ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã«é…ç½®ã•ã‚Œã¦ã„ãªã„ã€è¨ˆç®—ã‚µã‚¤ã‚¯ãƒ«ãŒä¸è¶³ã—ã¦ã„ã‚‹ãªã©ã®ç†ç”±ã«ã‚ˆã‚‹ã‚‚ã®ã§ã™ã€‚

To handle the different scenario, we define the `TestResult` type as follows:  
ç•°ãªã‚‹ã‚·ãƒŠãƒªã‚ªã«å¯¾å¿œã™ã‚‹ãŸã‚ã«ã€`TestResult` å‹ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ï¼š
```motoko
public type TestResult = Result.Result<(), TestError>;
public type TestError = {
    #UnexpectedValue : Text;
    #UnexpectedError : Text;
};
```
1. Implement the `test` function that takes a `canisterId` of type `Principal` and returns the result of the test of type `TestResult`. Make sure to distringuish between the two types of errors.  
`Principal` å‹ã® `canisterId` ã‚’å—ã‘å–ã‚Šã€`TestResult` å‹ã®ãƒ†ã‚¹ãƒˆçµæœã‚’è¿”ã™ `test` é–¢æ•°ã‚’å®Ÿè£…ã—ãªã•ã„ã€‚2ç¨®é¡ã®ã‚¨ãƒ©ãƒ¼ã‚’åŒºåˆ¥ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚
- UnexpectedValue should be returned whenever the calculator returns a wrong value. For instance, if a call to `reset` followed by `add(1)` returns 2.
- é›»å“ãŒé–“é•ã£ãŸå€¤ã‚’è¿”ã™ã¨ãã¯å¸¸ã« UnexpectedValue ã‚’è¿”ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€`reset` ã®å¾Œã« `add(1)` ã‚’å‘¼ã³å‡ºã™ã¨ã€2ãŒè¿”ã•ã‚Œã‚‹å ´åˆã§ã™ã€‚
- UnexpectedError should be returned for all other types of errors. For instance, if the function `add` is not even implemented as part of the canister's interface.
- ãã®ä»–ã®ã‚¿ã‚¤ãƒ—ã®ã‚¨ãƒ©ãƒ¼ã«ã¯ UnexpectedError ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€é–¢æ•° `add` ãŒã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®ä¸€éƒ¨ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ãªã„å ´åˆãªã©ã§ã™ã€‚
```motoko
test: shared (canisterId : Principal) -> async TestResult;
```
## Part 3: Verifying the controller of the calculator. / ç¬¬3å›ï¼šé›»å“ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’æ¤œè¨¼ã€‚
In this section we want to make sure that the owner of the verified canister is actually the student that registered it. Otherwise, a student could use the canister of another one.  
ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€æ¤œè¨¼ã•ã‚ŒãŸã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã®æ‰€æœ‰è€…ãŒã€å®Ÿéš›ã«ãã‚Œã‚’ç™»éŒ²ã—ãŸå­¦ç”Ÿã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ãã†ã§ãªã‘ã‚Œã°ã€ã‚ã‚‹å­¦ç”ŸãŒä»–ã®å­¦ç”Ÿã®ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚
### Step-by-step / ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—
Implement the `verifyOwnership` function that takes a `canisterId` of type `Principal` and a `principalId` of type `Principal` and returns a boolean indicating if the `principalId` is among the controllers of the canister corresponding to the `canisterId` provided.  
`Principal` å‹ã® `canisterId` ã¨ `Principal` å‹ã® `principalId` ã‚’å—ã‘å–ã‚Šã€æŒ‡å®šã•ã‚ŒãŸ `canisterId` ã«å¯¾å¿œã™ã‚‹ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ä¸­ã« `principalId` ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¤ºã™ãƒ–ãƒ¼ãƒ«å€¤ã‚’è¿”ã™é–¢æ•° `verifyOwnership` ã‚’å®Ÿè£…ã—ãªã•ã„ã€‚
```motoko
verifyOwnership : shared (Principal, Principal) -> async Bool;
```

> Tip: To implement step 3, you'll need to make an intercanister call to the management canister by using the `canister_status` method, which will return information on the canister among which are the list of controllers. The management canister is defined in the [ic.mo](./verifier/ic.mo). However, currently, the `canister_status` method can only be accessed when the calling canister is also the controller of the canister whose status you want to check. To overcome this limitation, you'll need to use a `try/catch` block to catch the error returned by the management, access the error message with `Error.message(e)` and then parse the message using the `parseControllersFromCanisterStatusErrorIfCallerNotController` method. I recommend reading the [dedicated topic on the forum](https://forum.dfinity.org/t/getting-a-canisters-controller-on-chain/7531/15)

> ãƒ’ãƒ³ãƒˆï¼šã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã®æƒ…å ±ã‚’è¿”ã—ã€ãã®ä¸­ã«ã¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ãƒªã‚¹ãƒˆã‚‚å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ç®¡ç†ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ã¯ [ic.mo](./verifier/ic.mo) ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€ç¾åœ¨ã€`canister_status` ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã®ã¯ã€å‘¼ã³å‡ºã—å…ƒã®ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ãŒã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèªã—ãŸã„ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã§ã‚‚ã‚ã‚‹å ´åˆã®ã¿ã§ã™ã€‚ã“ã®åˆ¶é™ã‚’å…‹æœã™ã‚‹ã«ã¯ã€`try/catch` ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãŒè¿”ã™ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã« `Error.message(e)` ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã€`parseControllersFromCanisterStatusErrorIfCallerNotController` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã§ã—ã‚‡ã†ã€‚[ãƒ•ã‚©ãƒ¼ãƒ©ãƒ ã®å°‚ç”¨ãƒˆãƒ”ãƒƒã‚¯](https://forum.dfinity.org/t/getting-a-canisters-controller-on-chain/7531/15) ã‚’èª­ã‚€ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚

```motoko
func parseControllersFromCanisterStatusErrorIfCallerNotController(errorMessage : Text) : [Principal] {
    let lines = Iter.toArray(Text.split(errorMessage, #text("\n")));
    let words = Iter.toArray(Text.split(lines[1], #text(" ")));
    var i = 2;
    let controllers = Buffer.Buffer<Principal>(0);
    while (i < words.size()) {
      controllers.add(Principal.fromText(words[i]));
      i += 1;
    };
    Buffer.toArray<Principal>(controllers);
  };
```
## Part 4: Graduation! ğŸ“ / ç¬¬4éƒ¨ï¼šå’æ¥­å¼ ğŸ“
In this sections the idea is to let students submit their work and automatically verify the canister. If the tests are passed then the `graduation` field of the student is automatically changed.  
ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€å­¦ç”Ÿã«ä½œå“ã‚’æå‡ºã•ã›ã€è‡ªå‹•çš„ã«ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã‚’æ¤œè¨¼ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¾ã™ã€‚ã‚‚ã—ãƒ†ã‚¹ãƒˆã«åˆæ ¼ã™ã‚Œã°ã€ãã®å­¦ç”Ÿã® `graduation` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯è‡ªå‹•çš„ã«å¤‰æ›´ã•ã‚Œã¾ã™ã€‚

### Step-by-step / ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—
Implement the `verifyWork` function that takes a `canisterId` of type `Principal` and a `principalId` of type `Principal` that corresponds to the identity of the student and perfoms the necessary verifications on the canister. If all the criteria for graduations are validated; then the `graduation` field of the student is updated accordingly. This function will returns  a `Ok` result indicating if the submitted project has been successfuly verified. This function will return a text message wrapped in an `Err` message in case the verification fails or something unexpected happens.  
å­¦ç”Ÿã® ID ã«å¯¾å¿œã™ã‚‹ `Principal` å‹ã® `canisterId` ã¨ `PrincipalId` ã‚’å—ã‘å–ã‚Šã€ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã«å¯¾ã—ã¦å¿…è¦ãªæ¤œè¨¼ã‚’è¡Œã† `verifyWork` é–¢æ•°ã‚’å®Ÿè£…ã—ãªã•ã„ã€‚å’æ¥­ã®ãŸã‚ã®ã™ã¹ã¦ã®åŸºæº–ãŒæ¤œè¨¼ã•ã‚ŒãŸå ´åˆã€å­¦ç”Ÿã® `graduation` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ãã‚Œã«å¿œã˜ã¦æ›´æ–°ã•ã‚Œã¾ã™ã€‚ã“ã®é–¢æ•°ã¯ã€æå‡ºã•ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒæ­£å¸¸ã«æ¤œè¨¼ã•ã‚ŒãŸã‹ã©ã†ã‹ã‚’ç¤ºã™ `Ok` result ã‚’è¿”ã—ã¾ã™ã€‚ã“ã®é–¢æ•°ã¯ã€æ¤œè¨¼ã«å¤±æ•—ã—ãŸå ´åˆã‚„äºˆæœŸã›ã¬ã“ã¨ãŒèµ·ã“ã£ãŸå ´åˆã«ã¯ã€`Err`ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ãƒ©ãƒƒãƒ—ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã—ã¾ã™ã€‚

```motoko
verifyWork: shared (canisterId : Principal, principalId: Principal) -> async Result.Result<(), Text>;
```

## ğŸ“º Interface / ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹
> At the end of the project your canister should implement the following interface:

> ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çµ‚äº†æ™‚ã«ã¯ã€ã‚­ãƒ£ãƒ‹ã‚¹ã‚¿ãƒ¼ã¯ä»¥ä¸‹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

```motoko
actor Verifier {
    // Part 1
    addMyProfile : shared StudentProfile -> async Result.Result<(),Text>;
    updateMyProfile : shared StudentProfile -> async Result.Result<(),Text>;
    deleteMyProfile : shared () -> async Result.Result<(),Text>;
    seeAProfile : shared Principal -> async Result.Result<StudentProfile, Text>;

    //Part 2
    test : shared Principal -> async TestResult;

    //Part 3
    verifyOwnership : shared (Principal, Principal) -> async Bool;

    //Part 4
    verifyWork : shared (Principal, Principal) -> async Result.Result<(), Text>;
};
```

## æœ€å¾Œã«
ã€Œæœ€å¾Œã«ã€ã¯ã€C3F ã® ICP é–‹ç™ºè€…ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã¦ã€Motoko Bootcamp ã‚’é€²ã‚ã¦ã„ã‚‹æ–¹ã«å‘ã‘ã¦ã®ã‚‚ã®ã§ã™ã€‚
å½“èª²é¡Œã‚’æ¶ˆåŒ–ã§ããŸã¨ã“ã‚ã§ã€C3F ã® Discord ã®ãƒãƒ£ãƒ³ãƒãƒ« \"#ã€c3fé–‹ç™ºã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã€‘\" ã¸ãã®æ—¨ã‚’å ±å‘Šã—ã¾ã—ã‚‡ã†ï¼ã‚‚ã—ãã¯ã€æ¶ˆåŒ–ãŒé›£ã—ã„å ´åˆã¯ã€è³ªå•ã—ã¾ã—ã‚‡ã†ï¼